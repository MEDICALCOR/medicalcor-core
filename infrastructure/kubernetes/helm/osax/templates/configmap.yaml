{{- /*
============================================================================
OSAX ConfigMap Template

Non-sensitive configuration for the application.
============================================================================
*/ -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "osax.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "osax.labels" . | nindent 4 }}
data:
  # Application configuration
  NODE_ENV: {{ .Values.global.environment | default "production" | quote }}
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"

  # Database configuration
  DB_HOST: {{ .Values.database.host | quote }}
  DB_PORT: {{ .Values.database.port | default 5432 | quote }}
  DB_NAME: {{ .Values.database.name | default "medicalcor_osax" | quote }}
  DB_SSL_MODE: {{ .Values.database.sslMode | default "require" | quote }}
  DB_POOL_MIN: {{ .Values.database.pool.min | default 5 | quote }}
  DB_POOL_MAX: {{ .Values.database.pool.max | default 20 | quote }}
  DB_IDLE_TIMEOUT_MS: {{ .Values.database.pool.idleTimeoutMs | default 30000 | quote }}
  DB_CONNECTION_TIMEOUT_MS: {{ .Values.database.pool.connectionTimeoutMs | default 5000 | quote }}

  # Feature flags
  METRICS_ENABLED: "true"
  TRACING_ENABLED: {{ .Values.app.env | default (dict) | dig "TRACING_ENABLED" "true" | quote }}
  STRICT_HIPAA_MODE: {{ .Values.app.env | default (dict) | dig "STRICT_HIPAA_MODE" "true" | quote }}
