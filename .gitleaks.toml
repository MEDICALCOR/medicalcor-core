# GitLeaks Configuration
# https://github.com/gitleaks/gitleaks

title = "MedicalCor GitLeaks Configuration"

# Use the default rules as a base
[extend]
useDefault = true

# Allowlist for files and paths that should be excluded from scanning
[allowlist]
description = "Global allowlist for known safe patterns"

# Exclude environment templates and example files (they contain placeholders, not real secrets)
paths = [
  '''.env\.example$''',
  '''.env\.template$''',
  '''.env\.production\.template$''',
  '''.env\.test$''',
  '''\.md$''',
  '''package-lock\.json$''',
  '''pnpm-lock\.yaml$''',
  '''\.gitleaks\.toml$''',
]

# Exclude test fixtures and mock data
regexTarget = "match"
regexes = [
  # Placeholder values commonly used in templates
  '''(?i)(password|secret|key|token)\s*[:=]\s*["']?(\$\{|\{\{|<|your-|example-|test-|dummy-|placeholder|changeme|xxxx)''',
  # Test/mock API keys with obvious fake patterns
  '''(?i)(sk|pk)_(test|live)_[a-z0-9]{24}''',
  # bcrypt hash examples in documentation
  '''\$2[ayb]\$[0-9]{2}\$[A-Za-z0-9./]{53}''',
]

# Additional rules to ignore specific patterns in this repository
[[rules]]
id = "env-template-placeholder"
description = "Ignore placeholder values in env templates"
regex = '''(?i)(API_KEY|SECRET|TOKEN|PASSWORD)\s*=\s*$'''
allowlist = { description = "Empty values in templates" }
